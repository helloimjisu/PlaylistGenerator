<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Spotify Playlist Generator</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">

    <link rel="stylesheet" href="css/reset.min.css">
    <link href='http://fonts.googleapis.com/css?family=Roboto:100,700,400' rel='stylesheet' type='text/css'>
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
    <link rel="stylesheet" href="css/main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<!--     <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"> -->
      <style type="text/css">
      #login, #loggedin {
        display: none;
      }
      .text-overflow {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        width: 500px;
      }
    </style>

  </head>

  <body>

<!-- top nav -->

<header>

      <nav>
<!--         <div class="container">
          <img src="img/spotifylogo.png" alt="spotifyLOGO" class="logo">
          <a href="#" class="brand-logo">Playlist Generator</a>
        </div> -->
    </nav>

</header>

<!-- end top nav -->
<div class="container">
    <div class="row">
      <div class="col s8 offset-s2 centered" id="login">
        <main class="intro">
          <h1 class="center-align">The Epic Playlist Generator</h1>
             <p class="center-align flow-text">The Epic Playlist Generator builds a playlist of dramatic movie soundtracks that you can play as you live your daily life. You choose how long you want the playlist to play. Then you can export your epic playlists to your Spotify account.
            </p>

            <p class="center-align flow-text">First, log in to Spotify to get started!</p>


            <div class="loginbutton center-align">
            <a href="/login" class="waves-effect waves-light btn-large">Log in with Spotify</a>
            </div>

            <span class="center-align flow-text">Don't have Spotify? Sign up <a href="https://www.spotify.com/us/" target="_blank">here</a>.</span>
        </main>
      </div>
    </div>
<!--    <footer>
  
        <p><span class="glyphicon glyphicon-heart"></span>Made with love by Ji Su Hiatt Design</p>
    </footer> -->


     <div class="row">
        <div class="col s8 offset-s2">


          <div class="card white darken-1">
            <div class="card-content">
              <span class="card-title left-align">What do you want to listen to?</span>
                <div id="loggedin">
        <div id="user-profile">
        </div>
        <div id="oauth">
        </div>
        <button class="btn btn-default" id="obtain-new-token">Obtain new token using the refresh token</button>
      </div>
      
      <input type="text"/>
<button>Go</button>
<img src=""/>

               <!-- Dropdown Trigger -->
                <div class="center-align">
                  <a class='waves-effect waves-light dropdown-button btn center-align' href='#' data-activates='dropdown1'>Choose a Genre</a>


                <!-- Dropdown Structure -->
                  <ul id='dropdown1' class='dropdown-content'>
                    <li><a href="#!">Pop</a></li>
                    <li><a href="#!">R&B and Soul</a></li>
                    <li><a href="#!">Rap/Hip Hop</a></li>
                    <li><a href="#!">Rock/Alternative Rock</a></li>
                    <li><a href="#!">Asian Pop</a></li>
                    <li><a href="#!">Country</a></li>
                    <li><a href="#!">Soundtracks</a></li>
                    <li><a href="#!">Classical</a></li>
                  </ul>
                </div>

          <span class="card-title left-align">For how long?</span>

          <div class="center-align"> <p>[insert slider here]</p> </div>

      </div>
    </div>


          <!-- playlist -->


          <div class="card white darken-1">
            <div class="card-content">
              <span class="card-title">Here is your personalized playlist!</span>

              <div class="divider"></div>
              <div class="section hoverable">
                <h5>Arwen's Vigil</h5>
                <p>The Piano Guys</p>
              </div>
              <div class="divider"></div>
              <div class="section hoverable">
                <h5>The River Flows in You</h5>
                <p>Yiruma</p>
              </div>
              <div class="divider"></div>
              <div class="section hoverable">
                <h5>Song</h5>
                <p>Artist</p>
              </div>
            </div>
          </div>

        </div>
      </div>
</div>



      <!-- what user sees after they log in -->

<div class="container">
      <div id="login">
        <h1>This is an example of the Authorization Code flow</h1>
        <a href="/login" class="btn btn-primary">Log in with Spotify</a>
      </div>



    </div>

    <script id="user-profile-template" type="text/x-handlebars-template">
      <h1>Logged in as {{display_name}}</h1>
      <div class="media">
        <div class="pull-left">
          <img class="media-object" width="150" src="{{images.0.url}}" />
        </div>
        <div class="media-body">
          <dl class="dl-horizontal">
            <dt>Display name</dt><dd class="clearfix">{{display_name}}</dd>
            <dt>Id</dt><dd>{{id}}</dd>
            <dt>Email</dt><dd>{{email}}</dd>
            <dt>Spotify URI</dt><dd><a href="{{external_urls.spotify}}">{{external_urls.spotify}}</a></dd>
            <dt>Link</dt><dd><a href="{{href}}">{{href}}</a></dd>
            <dt>Profile Image</dt><dd class="clearfix"><a href="{{images.0.url}}">{{images.0.url}}</a></dd>
            <dt>Country</dt><dd>{{country}}</dd>
          </dl>
        </div>
      </div>
    </script>

    <script id="oauth-template" type="text/x-handlebars-template">
      <h2>oAuth info</h2>
      <dl class="dl-horizontal">
        <dt>Access token</dt><dd class="text-overflow">{{access_token}}</dd>
        <dt>Refresh token</dt><dd class="text-overflow">{{refresh_token}}></dd>
      </dl>
    </script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script>
      (function() {
        /**
         * Obtains parameters from the hash of the URL
         * @return Object
         */
        function getHashParams() {
          var hashParams = {};
          var e, r = /([^&;=]+)=?([^&;]*)/g,
              q = window.location.hash.substring(1);
          while ( e = r.exec(q)) {
             hashParams[e[1]] = decodeURIComponent(e[2]);
          }
          return hashParams;
        }
        var userProfileSource = document.getElementById('user-profile-template').innerHTML,
            userProfileTemplate = Handlebars.compile(userProfileSource),
            userProfilePlaceholder = document.getElementById('user-profile');
        var oauthSource = document.getElementById('oauth-template').innerHTML,
            oauthTemplate = Handlebars.compile(oauthSource),
            oauthPlaceholder = document.getElementById('oauth');
        var params = getHashParams();
        var access_token = params.access_token,
            refresh_token = params.refresh_token,
            error = params.error;
        if (error) {
          alert('There was an error during the authentication');
        } else {
          if (access_token) {
            // render oauth info
            oauthPlaceholder.innerHTML = oauthTemplate({
              access_token: access_token,
              refresh_token: refresh_token
            });
            $.ajax({
                url: 'https://api.spotify.com/v1/me',
                headers: {
                  'Authorization': 'Bearer ' + access_token
                },
                success: function(response) {
                  userProfilePlaceholder.innerHTML = userProfileTemplate(response);
                  $('#login').hide();
                  $('#loggedin').show();
                }
            });
          } else {
              // render initial screen
              $('#login').show();
              $('#loggedin').hide();
          }
          document.getElementById('obtain-new-token').addEventListener('click', function() {
            $.ajax({
              url: '/refresh_token',
              data: {
                'refresh_token': refresh_token
              }
            }).done(function(data) {
              access_token = data.access_token;
              oauthPlaceholder.innerHTML = oauthTemplate({
                access_token: access_token,
                refresh_token: refresh_token
              });
            });
          }, false);
        }
      })();
    </script>

<footer class="page-footer">
          <div class="footer-copyright">
            <div class="container">
            Â© 2015 Copyright Ji Su Hiatt Design
             <a class="grey-text text-lighten-4 right" href="https://developer.spotify.com/web-api/">Powered by Spotify Web API</a> 
            </div>
          </div>
</footer>
    

    <script type="text/javascript" src="js/materialize.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>
    <script src="js/spotify-web-api.js"></script>
    <script src="js/app.js"></script>
</body>
</html>

